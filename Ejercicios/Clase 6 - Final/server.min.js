!function(n,t,r,e,c,a,o,u){function i(){var t=n.getItem("contacts");return c.parse(t||"{}")}function f(t){n.setItem("contacts",c.stringify(t))}function s(n){var t=n.replace("/contacts","");return t.indexOf("/")!=-1?t.replace("/",""):null}function d(n){return v().then(function(){if(!n||!n.id||!i()[n.id])throw"Contact could not be found";var t=i();return t[n.id]=n,f(t),n})}function l(t){return v().then(function(){if(t){var r=i();delete r[t],f(r)}else n.clear(),f({});return!0})}function h(n){return v().then(function(){if(n)return i()[n];var t=u.getOwnPropertyNames(i()),r=[];return t.forEach(function(n){r.push(i()[n])}),r})}function v(n){var t=new e(function(t,e){r(function(){var r=n||a.random()<=.1;r?e("Internal Server Error"):t()},10*a.random())});return t}function m(){return v(!0)}t.ajax=function(n,t){if(0!=n.indexOf("/contacts"))return m();switch(t.method){case"POST":return p(t.data.contact);case"PUT":return d(t.data.contact);case"DELETE":return l(s(n));case"GET":default:return h(s(n))}};var p=function(){var n=u.getOwnPropertyNames(i()),t=0;return n.forEach(function(n){t=o.parseInt(n)>t?o.parseInt(n):t}),function(n){return v().then(function(){if(n){n.contactId=++t;var r=i();return r[t]=n,f(r),n}throw"Contact cannot be null"})}}()}(localStorage,$,setTimeout,Promise,JSON,Math,Number,Object);